- name: Clone oh-my-zsh
  git: repo=https://github.com/robbyrussell/oh-my-zsh dest=~/.oh-my-zsh update=no
  # .zshrc will be generated later by the dotfile entries

- name: Check if oh-my-zsh is customized by us
  stat: path=~/.oh-my-zsh/custom/.git
  register: zsh_custom_repo

- name: Delete custom dir if it does not contain our repo
  file: path=~/.oh-my-zsh/custom state=absent
  when: not zsh_custom_repo.stat.exists

- name: Checkout oh-my-zsh customizations
  git: repo=git@github.com:gbirke/oh-my-zsh-customizations.git dest=~/.oh-my-zsh/custom